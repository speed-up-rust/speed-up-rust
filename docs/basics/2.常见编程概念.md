# å¸¸è§ç¼–ç¨‹æ¦‚å¿µ

## å˜é‡ä¸å¯å˜æ€§

Rust ä¸­ä½¿ç”¨ `let` å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼š

```rust
let x = 5;
println!("The value of x is {x}");

x = 6; // [!code error] // cannot assign twice to immutable variable `x`
println!("The value of x is {x}");
```

ä½¿ç”¨ `mut` æ ‡è¯†å¯å˜å˜é‡ï¼š
```rust
let x = 5; // [!code --]
let mut x = 5; // [!code ++]
println!("The value of x is {x}");

x = 6;
println!("The value of x is {x}");
```

### å¸¸é‡

Rust ä¸­ä½¿ç”¨ `const` å£°æ˜ä¸€ä¸ªå¸¸é‡ï¼Œæœ‰ä»¥ä¸‹æ³¨æ„äº‹é¡¹ï¼š

- ä¸å…è®¸å¯¹å¸¸é‡ä½¿ç”¨ `mut`ï¼Œå¸¸é‡æ€»æ˜¯ä¸å¯å˜çš„ã€‚
- å¿…é¡»æ˜¾å¼æ³¨æ˜å¸¸é‡å€¼çš„ç±»å‹ã€‚
- ä¸å¯ä»¥è®¾ç½®åªèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—å‡ºçš„å€¼ã€‚
- å‘½åçº¦å®šï¼šå•è¯ä¹‹é—´ä½¿ç”¨å…¨å¤§å†™åŠ ä¸‹åˆ’çº¿ã€‚

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

### éšè—

Rust ä¸­å…è®¸å®šä¹‰ä¸€ä¸ªä¸ä¹‹å‰å˜é‡åŒåçš„æ–°å˜é‡ï¼Œç§°ç¬¬ä¸€ä¸ªå˜é‡è¢«ç¬¬äºŒä¸ªå˜é‡éšè—äº†ï¼š

```rust
let spaces = "    ";
let spaces = spaces.len();
```

å¦‚æœå°è¯•ä½¿ç”¨ `mut`ï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```rust
let mut spaces = "    ";
spaces = spaces.len(); // [!code error] // mismatched types
```

## æ•°æ®ç±»å‹

### æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„å€¼ã€‚Rust æœ‰å››ç§åŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼š
1. æ•´å‹
2. æµ®ç‚¹å‹
3. å¸ƒå°”ç±»å‹
4. å­—ç¬¦ç±»å‹

#### æ•´å‹

Rust æ”¯æŒä»¥ä¸‹æ•´æ•°ç±»å‹ï¼š

| é•¿åº¦ | æœ‰ç¬¦å· | æ— ç¬¦å· |
| -- | -- | -- |
| 8-bit | `i8` | `u8` |
| 16-bit | `i16` | `u16` |
| 32-bit | `i32` | `u32` |
| 64-bit | `i64` | `u64` |
| 128-bit | `i128` | `u128` |
| arch | `isize` | `usize` |

Rust åªçš„æ•´å‹å­—é¢é‡ï¼š

| æ•°å­—å­—é¢é‡ | ä¾‹å­ |
| -- | -- |
| Decimal (åè¿›åˆ¶) | `98_222` |
| Hex (åå…­è¿›åˆ¶) | `0xff` |
| Octal (å…«è¿›åˆ¶) | `0o77` |
| Binary (äºŒè¿›åˆ¶) | `0b1111_0000` |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äº`u8`) | `b'A'` |

æ•°å­—å­—é¢å€¼å…è®¸ä½¿ç”¨ç±»å‹åç¼€ï¼š
```rust
let num = 57u8;
```

::: warning æ•´æ•°æº¢å‡º
ä¾‹å¦‚æœ‰ä¸€ä¸ª `u8` ç±»å‹ï¼Œå®ƒå¯ä»¥å­˜æ”¾ `0..=255` åŒºé—´çš„å€¼ï¼Œå¦‚æœå°†å…¶ä¿®æ”¹ä¸º `256`ï¼š
- `debug` æ¨¡å¼ä¸‹ç¨‹åºä¼š panicã€‚
- `release` æ¨¡å¼ä¸‹ï¼ŒRust ä¼šè¿›è¡Œ**å›ç»•**æ“ä½œï¼Œå€¼ `256` å˜ä¸º `0`ï¼Œå€¼ `257` å˜ä¸º `0`ã€‚
:::

#### æµ®ç‚¹å‹

Rust ä¸­æœ‰ä¸¤ä¸ªåŸç”Ÿçš„æµ®ç‚¹æ•°ç±»å‹ï¼š
1. å•ç²¾åº¦æµ®ç‚¹æ•° `f32`
2. åŒç²¾åº¦æµ®ç‚¹æ•° `f64`ï¼ˆé»˜è®¤æµ®ç‚¹ç±»å‹ï¼‰

```rust
let x = 2.0; // f64
let y: f32 = 3.0; // f32
```

##### æ•°å€¼è¿ç®—

```rust
// åŠ æ³•
let sum = 5 + 10;
// å‡æ³•
let difference = 95.5 - 4.3;
// ä¹˜æ³•
let product = 4 * 30;
// é™¤æ³•
let quotient = 56.7 / 32.3;
let truncated = -5 / 3; // ç»“æœä¸º -1
// å–ä½™
let remainder = 43 % 5;
```

#### å¸ƒå°”å‹

Rust ä¸­çš„å¸ƒå°”ç±»å‹ä½¿ç”¨ `bool` è¡¨ç¤ºï¼Œæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š

```rust
let t = true;
let f: bool = false;
```

#### å­—ç¬¦ç±»å‹

Rust ä¸­çš„å­—ç¬¦ç±»å‹ä½¿ç”¨ `char` è¡¨ç¤ºï¼Œå ç”¨å››ä¸ªå­—èŠ‚ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼š

```rust
let c = 'z';
let z: char = 'Z';
let heart_eysed_cat = 'ğŸ˜»';
```

### å¤åˆç±»å‹

å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ï¼ŒRust ä¸­æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ã€æ•°ç»„ã€‚

#### å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ï¼Œå®ƒçš„é•¿åº¦å›ºå®šï¼Œæ¯ä¸ªå…ƒç´ çš„ç±»å‹ä¸å¿…ç›¸åŒï¼š

```rust
// å£°æ˜å…ƒç»„
let tup: (i32, f64, u8) = (500, 6.4, 1);

// è®¿é—®å…ƒç»„ä¸­çš„å…ƒç´ 
println!("The first value of tup is: {}", tup.0);

// è§£æ„èµ‹å€¼
let (x, y, z) = tup;
```

#### æ•°ç»„ç±»å‹

æ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚

```rust
// å£°æ˜ä¸€ä¸ªæ•°ç»„
let a = [1, 2, 3, 4, 5];

// æ˜¾å¼å£°æ˜æ•°ç»„ç±»å‹
let a: [i32; 5] = [1, 2, 3, 4, 5];

// å¿«é€Ÿåˆ›å»ºå…ƒç´ ç›¸åŒçš„æ•°ç»„
let a = [3; 5]; // [3, 3, 3, 3, 3]

// è®¿é—®æ•°ç»„å…ƒç´ 
let first = a[0];
let second = a[1];
```

Rust ä¸­çš„æ•°ç»„æ˜¯åˆ†é…åœ¨æ ˆï¼ˆStackï¼‰ä¸Šçš„ã€‚

Vector ç±»å‹æ˜¯æ ‡å‡†åº“æä¾›çš„**å…è®¸**å¢é•¿å’Œç¼©å°é•¿åº¦çš„ç±»ä¼¼æ•°ç»„çš„é›†åˆç±»å‹ï¼Œåˆ†é…åœ¨å †ï¼ˆHeapï¼‰ä¸Šã€‚

## å‡½æ•°

Rust ä¸­çš„å‡½æ•°ä½¿ç”¨ `fn` å…³é”®å­—å£°æ˜ï¼Œéµå¾ª *snake case* å‘½åè§„èŒƒï¼š

```rust
// å£°æ˜ä¸€ä¸ªå‡½æ•°
fn another_function() {
    println!("Another function.");
}

// ä¸ºå‡½æ•°æŒ‡å®šå‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹
fn add(a: i32, b: i32) -> i32 {
    return a + b;
}

// å—çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ä¼šè¢«å½“ä½œå‡½æ•°çš„è¿”å›å€¼
fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ Rust ä¼šå°†ä»£ç å—çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼å½“ä½œä»£ç å—çš„è¿”å›å€¼ï¼Œè¯¥ç‰¹æ€§è¿˜è¢«åº”ç”¨äº `if` è¡¨è¾¾å¼ã€`loop` å¾ªç¯è¡¨è¾¾å¼ä¸­ã€‚

## æ³¨é‡Š

```rust

// è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ³¨é‡Š

/**
 * è¿™æ˜¯ä¸€ä¸ªå—çº§æ³¨é‡Š
 */

/// è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£æ³¨é‡Š
/// Adds one to the number given.
///
/// # Examples
///
/// ```
/// let arg = 5;
/// let answer = my_crate::add_one(arg);
///
/// assert_eq!(6, answer);
/// ```
pub fn add_one(x: i32) -> i32 {
    x + 1
}
```

## æ§åˆ¶æµ

### `if` è¡¨è¾¾å¼

`if` è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶å¿…é¡»æ˜¯ `bool` å€¼ã€‚

```rust
let number = 6;

if number % 4 == 0 {
    println!("number is divisible by 4");
} else if number % 3 == 0 {
    println!("number is divisible by 3");
} else if number % 2 == 0 {
    println!("number is divisible by 2");
} else {
    println!("number is not divisible by 4, 3, or 2");
}
```

Rust è¯­è¨€ä¸­æ²¡æœ‰ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ `if` è¡¨è¾¾å¼å®ç°ï¼š

```rust
let condition = true;
let number = if condition { 5 } else { 6 };

println!("The value of number is: {number}");

let number = if condition { 5 } else { "six" }; // [!code error] // expected integer, found `&str`
```

### `loop` æ— é™å¾ªç¯

`loop` ä¸ºæ— é™å¾ªç¯ï¼Œå¾ªç¯ä½“ä¸­çš„ä»£ç å°†è¢«åå¤æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ° `break` åœæ­¢ï¼Œ`break` åçš„å€¼ä¼šè¢«å½“ä½œ `loop` è¡¨è¾¾å¼çš„è¿”å›å€¼ã€‚

```rust
let mut counter = 0;

let result = loop {
    counter += 1;

    if counter == 10 {
        break counter * 2;
    }
};

println!("The result is {}", result);
```

é‡åˆ°åµŒå¥—å¾ªç¯æ—¶ï¼Œå¯ä»¥ç»™å¾ªç¯è¡¨è¾¾å¼æ‰“ä¸Šæ ‡ç­¾ï¼Œä»è€Œåœ¨ `break` çš„æ—¶å€™é€‰æ‹©éœ€è¦è·³å‡ºçš„å¾ªç¯å±‚çº§ï¼š

```rust
let mut count = 0;
'counting_up: loop {
    println!("count = {count}");
    let mut remaining = 10;

    loop {
        println!("remaining = {remaining}");
        if remaining == 9 {
            break; // è·³å‡ºå†…å±‚å¾ªç¯
        }
        if count == 2 {
            break 'counting_up; // è·³å‡ºæœ€å¤–å±‚å¾ªç¯
        }
        remaining -= 1;
    }

    count += 1;
}
println!("End count = {count}");
```

### `while` æ¡ä»¶å¾ªç¯

`while` å¾ªç¯åœ¨æ¯æ¬¡å¾ªç¯å‰éƒ½ä¼šåˆ¤æ–­æ¡ä»¶ï¼Œæ˜¯å¦æ¡ä»¶ä¸º `true` åˆ™æ‰§è¡Œå¾ªç¯ï¼Œå¦åˆ™ç»ˆæ­¢å¾ªç¯ã€‚

```rust
let mut number = 3;

while number != 0 {
    println!("{number}!");

    number -= 1;
}

println!("LIFTOFF!!!");
```

### `for` éå†é›†åˆ

åœ¨ Rust ä¸­å¯ä»¥ä½¿ç”¨ `for` æ¥è½»æ¾çš„éå†é›†åˆï¼š

```rust
let a = [10, 20, 30, 40, 50];

for element in a {
    println!("the value is: {element}");
}

// éå†ä¸€ä¸ª range
for number in (1..4).rev() {
    println!("{number}!");
}
println!("LIFTOFF!!!");
```
